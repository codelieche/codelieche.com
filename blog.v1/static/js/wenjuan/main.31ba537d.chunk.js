(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{130:function(e,t,a){e.exports=a(275)},273:function(e,t,a){},275:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(17),c=a.n(i),s=a(11),l=a(12),o=a(14),u=a(13),d=a(15),m=a(277),h=a(279),p=a(278),f=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={reFresh:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e,t=this.props.history.location.pathname;try{e=window.localStorage.reFreshPathname,window.localStorage.reFreshPathname=t}catch(a){e=t}t!==e&&(console.log(e,t),window.location.reload())}},{key:"render",value:function(){return null}}]),t}(n.Component),j=(a(135),a(16)),b=(a(93),a(38)),E=(a(94),a(29)),v=(a(114),a(37)),O=(a(96),a(49)),w=(a(97),a(44)),y=(a(148),a(128)),g=(a(151),a(92)),D=(a(154),a(91)),k=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={data:a.props.data?a.props.data:{},index:a.props.index},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.getFieldDecorator;if("radio"===this.state.data.category){var t=this.state.data.choices.map(function(e,t){return r.a.createElement(D.a,{value:e.option,key:t},e.value)});return r.a.createElement(v.a.Item,{label:"".concat(this.state.index,". ").concat(this.state.data.title),help:this.state.data.description},e("question_".concat(this.state.data.id),{rules:[{required:!0,message:this.state.data.title}]})(r.a.createElement(D.a.Group,null,t)))}if("checkbox"===this.state.data.category){var a=this.state.data.choices.map(function(e,t){return r.a.createElement(g.a,{value:e.option,key:t},e.value)});return r.a.createElement(v.a.Item,{label:"".concat(this.state.index,". ").concat(this.state.data.title),help:this.state.data.description},e("question_".concat(this.state.data.id),{rules:[{required:!0,message:this.state.data.title}]})(r.a.createElement(g.a.Group,null,a)))}return r.a.createElement(v.a.Item,{label:"".concat(this.state.index,". ").concat(this.state.data.title),help:this.state.data.description},e("question_".concat(this.state.data.id),{rules:[{required:!0,message:this.state.data.title}]})(r.a.createElement(y.a,{placeholder:""})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data!==t.data||e.index!==t.index?{data:e.data,index:e.index}:null}}]),t}(r.a.Component);var N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getFormItems=function(e){return a.state.questions&&a.state.questions.length>0?a.state.questions.map(function(t,a){return r.a.createElement(k,{key:a,index:a+1,data:t,getFieldDecorator:e})}):r.a.createElement("div",null,"\u65e0\u9009\u9879")},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e?console.log(e):a.props.handleSubmit(t)})},a.state={questisons:a.props.questions},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this.props.form,a=t.getFieldDecorator,n=t.getFieldsError;return r.a.createElement(v.a,{onSubmit:this.handleSubmit},this.getFormItems(a),r.a.createElement(O.a,{className:"center button"},r.a.createElement(w.a,{type:"primary",htmlType:"submit",disabled:(e=n(),Object.keys(e).some(function(t){return e.field}))},"\u63d0\u4ea4\u95ee\u5377")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.questions!==t.questions?{questions:e.questions}:null}}]),t}(r.a.Component),S=v.a.create()(N),q=E.a.Header,F=E.a.Footer,x=E.a.Content,C=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).fetchDetailData=function(){var e="/api/v1/wenjuan/job/"+a.state.id;fetch(e,{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.id?a.setState({detail:e}):b.a.error(JSON.stringify(e),5)}).catch(function(e){return console.log(e)})},a.handleAddSubmit=function(e){e.job=a.state.detail.id;fetch("/api/v1/wenjuan/report/create",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){e.id>0?(b.a.success("\u95ee\u5377\u56de\u7b54\u6210\u529f",3),a.props.history.push("/wenjuan/report/".concat(e.id))):b.a.error(JSON.stringify(e),5)}).catch(function(e){return console.log(e)})},a.state={id:a.props.match.params.id,detail:{}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchDetailData()}},{key:"render",value:function(){return r.a.createElement(E.a,{className:"wenjuan"},r.a.createElement(q,null,r.a.createElement("div",{className:"title float-l"},"\u95ee\u5377\u8c03\u67e5 ",r.a.createElement(j.a,{type:"edit"})),r.a.createElement("div",{className:"title float-r"},this.state.detail.title)),r.a.createElement("div",{className:"description"},this.state.detail.description?this.state.detail.description:this.state.detail.title),r.a.createElement(x,null,r.a.createElement("div",{className:"container wenjuan wenjuan-job"},r.a.createElement("div",{className:"forms"},r.a.createElement(S,{questions:this.state.detail.questions,handleSubmit:this.handleAddSubmit})))),r.a.createElement(F,null,r.a.createElement("span",null,"\u611f\u8c22\u60a8\u7684\u53c2\u4e0e\uff01")))}}]),t}(n.Component),I=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(p.a,{exat:!0,path:"/wenjuan/job/:id",component:C}))}}]),t}(n.Component),J=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getAnswersItems=function(){return a.state.answers&&a.state.answers.length>0?a.state.answers.map(function(e,t){return r.a.createElement("div",{className:"answer-item",key:t},r.a.createElement("div",{className:"title"},t+1,". ",e.question),r.a.createElement("div",{className:"answer"},e.answer))}):r.a.createElement("h1",null,"\u65e0\u7b54\u5377\u6570\u636e")},a.state={answers:a.props.answers?a.props.answers:[]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.getAnswersItems())}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.answers!==t.answers?{answers:e.answers}:null}}]),t}(r.a.Component),P=E.a.Header,T=E.a.Content,A=E.a.Footer,G=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).fetchDetailData=function(){var e="/api/v1/wenjuan/report/"+a.state.id;fetch(e,{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.id?(a.setState({detail:e}),a.fetchJobDetailData(e.job)):b.a.error(JSON.stringify(e),5)}).catch(function(e){return console.log(e)})},a.fetchJobDetailData=function(e){fetch("/api/v1/wenjuan/job/"+e,{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.id?a.setState({jobDetail:e}):b.a.error(JSON.stringify(e),5)}).catch(function(e){return console.log(e)})},a.state={id:a.props.match.params.id,detail:{},jobDetail:{}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchDetailData()}},{key:"render",value:function(){return r.a.createElement(E.a,{className:"wenjuan"},r.a.createElement(P,null,r.a.createElement("div",{className:"title float-l"},"\u7b54\u5377"),r.a.createElement("div",{className:"title float-r"},this.state.jobDetail.title)),r.a.createElement("div",{className:"description"},this.state.jobDetail.description?this.state.jobDetail.description:this.state.jobDetail.title),r.a.createElement(T,null,r.a.createElement("div",{className:"container wenjuan wenjuan-report"},r.a.createElement("div",{className:"answers"},r.a.createElement(O.a,{className:"title"},r.a.createElement("h4",null,"\u56de\u7b54\u4fe1\u606f")),r.a.createElement(J,{answers:this.state.detail.answers}),r.a.createElement(O.a,{className:"title"},r.a.createElement("h4",null,"\u57fa\u672c\u4fe1\u606f")),r.a.createElement("div",{className:"info-property"},r.a.createElement("dl",null,r.a.createElement("dt",null,"\u6dfb\u52a0\u8005"),r.a.createElement("dd",null,this.state.detail.user?this.state.detail.user:"---")),r.a.createElement("dl",null,r.a.createElement("dt",null,"\u56de\u7b54IP"),r.a.createElement("dd",null,this.state.detail.ip)),r.a.createElement("dl",null,r.a.createElement("dt",null,"\u56de\u7b54\u65f6\u95f4"),r.a.createElement("dd",null,this.state.detail.time_added)))))),r.a.createElement(A,null,r.a.createElement("span",null,"\u611f\u8c22\u60a8\u7684\u53c2\u4e0e\uff01")))}}]),t}(n.Component),_=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(p.a,{exat:!0,path:"/wenjuan/report/:id",component:G}))}}]),t}(n.Component),M=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(p.a,{path:"/wenjuan/job",component:I,location:this.props.location}),r.a.createElement(p.a,{path:"/wenjuan/report",component:_,location:this.props.location}))}}]),t}(r.a.Component),H=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(h.a,null,r.a.createElement(p.a,{path:"/wenjuan",render:function(e){return r.a.createElement(M,e)}}),r.a.createElement(p.a,{component:f})))}}]),t}(r.a.Component);a(273);c.a.render(r.a.createElement(H,null),document.getElementById("root"))}},[[130,2,1]]]);
//# sourceMappingURL=main.31ba537d.chunk.js.map